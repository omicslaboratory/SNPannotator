column(9,
DTOutput("calcLD_output",width = "50%",fill = TRUE,height = "100%"),
div(
id = "loading-spinner_2",
class = "shiny-spinner-hidden",
tags$div(class = "shiny-spinner-container",
tags$div(class = "shiny-spinner"))
)))
),
#### Third Tab #### rsid finder
tabItem(
tabName = "rsidFinderTab",
h2("Find rsID"),
p("You can use this tab to find rsIDs in a genomic region."),
tags$div(class = "hline"),
fluidRow(column(2,
fluidRow(column(12, textInput(inputId = "chr_rsfindertab", label = tags$div(class = "label-on-top", "Chromosome:"), placeholder = '1',width = "100%"))),
fluidRow(column(12, textInput(inputId = "pos_1_rsfindertab", label = tags$div(class = "label-on-top", "Start position:"), placeholder = '1000',width = "100%"))),
fluidRow(column(12, textInput(inputId = "pos_2_rsfindertab", label = tags$div(class = "label-on-top", "End position:"), placeholder = '1001',width = "100%"))),
fluidRow(column(12, selectInput(
inputId = "build_rsfindertab",
label = "Genomic build:",
choices = c("37" = "37",
"38" = "38"),
selected = "37"
))),
br(),
fluidRow(column(12, actionButton("run_rsfindertab", "Run", class = "btn-primary",width = "40%")))),
column(1,div(id ="vl",class = "vertical-line")),
column(9,
DTOutput("findrsidtab_output",width = "50%",fill = TRUE,height = "100%"),
div(
id = "loading-spinner_rsfindertab",
class = "shiny-spinner-hidden",
tags$div(class = "shiny-spinner-container",
tags$div(class = "shiny-spinner"))
)))
),
#### Fourth Tab #### genpos finder
tabItem(
tabName = "genposFinderTab",
h2("Find genomic position"),
p("You can use this tab to find genomic position of a variant based on rsID."),
tags$div(class = "hline"),
fluidRow(column(2,
fluidRow(column(12, textInput("rsid_genposfindertab", label = tags$div(class = "label-on-top", "rsID:"), placeholder = 'rs234',width = "100%"))),
br(),
fluidRow(column(12, actionButton("run_genposfindertab", "Run", class = "btn-primary",width = "40%")))),
column(1,div(id ="vl",class = "vertical-line")),
column(9,
DTOutput("genposfinder_output",width = "50%",fill = TRUE,height = "100%"),
div(
id = "loading-spinner_genposfindertab",
class = "shiny-spinner-hidden",
tags$div(class = "shiny-spinner-container",
tags$div(class = "shiny-spinner"))
)))
),
##### Fifth Tab #### annotator
tabItem(
tabName = "annotateTab",
h2("Annotate a genetic variant"),
p("You can annotate a variants using data from Ensembl."),
tags$div(class = "hline"),
fluidRow(column(2,
fluidRow(column(12, textInput("variantID_3", label = tags$div(class = "label-on-top", "Variant ID:"), placeholder = 'rs234',width = "100%"))),
fluidRow(column(12, selectInput(
inputId = "build_3",
label = "Genomic build:",
choices = c("37" = "grch37",
"38" = "grch38"),
selected = "grch37"
))),
fluidRow(column(12, numericInput("window_3", "Window Size:", value = 500,min = 150,max=500,step = 50,width = "100%"))),
fluidRow(column(12, numericInput("r2_3", "R2:", value = 0.8,min = 0.8,max=1,step = 0.05,width = "100%"))),
fluidRow(column(12, selectInput(
inputId = "population_3",
label = "Select Population:",
choices = c("European" = "eur",
"African" = "afr",
"American" = "amr",
"All" = "all"
),
selected = "European"
))),
fluidRow(column(12, selectInput(
inputId = "LDlist_3",
label = "Include proxy variants:",
choices = c("Yes" = "yes",
"No" = "no"
),
selected = "no"
))),
br(),
fluidRow(column(12, actionButton("run_3", "Run", class = "btn-primary",width = "40%")))),
column(1,div(id ="vl",class = "vertical-line")),
column(9,
DTOutput("annotator_output",width = "100%",fill = FALSE,height = "100%"),
div(
id = "loading-spinner_3",
class = "shiny-spinner-hidden",
tags$div(class = "shiny-spinner-container",
tags$div(class = "shiny-spinner"))
)
)))
),
tags$footer(
class = "footer",
HTML("Â© 2025 SNPannotator | All Rights Reserved | <a href='https://www.gnu.org/licenses/gpl-3.0.html' target='_blank'>GPL-3</a>")
)
)
)
#### Define Server  ####
server <- function(input, output, session) {
##### 1st Run button click #####
observeEvent(input$run_1, {
rsID <- input$variantID_1
build <- input$build_1
window <- input$window_1
r2 <- input$r2_1
db <- switch(input$population_1,
'eur'='1000GENOMES:phase_3:EUR',
'afr'='1000GENOMES:phase_3:AFR',
'amr'='1000GENOMES:phase_3:AMR',
'1000GENOMES:phase_3:ALL'
)
# Validate inputs
if (is.null(rsID) | is.na(rsID) | rsID=='' | !startsWith(rsID,'rs')) {
showNotification("Please provide valid input.", type = "error")
return()
}else{
shinyjs::disable('run_1')
shinyjs::show("loading-spinner_1")
out <- tryCatch({
SNPannotator::findProxy(rslist = rsID,build = build,window_size = window,r2 = r2,db = db)
},
error = function(e)
{
showNotification(paste0("Error:",e$message), type = "error")
NULL
})
if(!is.null(out))
output$findLD_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
options = list(
scroller = TRUE,
scrollY = "300px",
dom = 'lfrtBip',
buttons = c('copy', 'csv', 'excel'),
columnDefs = list(
list(className = 'dt-center', targets = "_all")
)
),
class = "compact cell-border stripe"
)
})
else
{
showNotification("No Proxies were found.", type = "error")
output$findLD_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_1')
shinyjs::hide("loading-spinner_1")
}
})
##### 2nd Run button click #####
observeEvent(input$run_2, {
rsIDs <- strsplit(input$variantIDs_2, "\\n")[[1]]
build <- input$build_2
pairwise <- switch(input$pairwise_2,
'no'=FALSE,
'yes'=TRUE)
db <- switch(input$population_2,
'eur'='1000GENOMES:phase_3:EUR',
'afr'='1000GENOMES:phase_3:AFR',
'amr'='1000GENOMES:phase_3:AMR',
'1000GENOMES:phase_3:ALL')
# Validate inputs
if (length(rsIDs) <2)
{
showNotification("Please provide at least two valid rsIDs.", type = "error")
return()
}else{
shinyjs::disable('run_2')
shinyjs::show("loading-spinner_2")
out <- tryCatch({
SNPannotator::findPairwiseLD(rsList = rsIDs,build = build, db = db,pairwise = pairwise)
},
error = function(e)
{
showNotification(paste0("Error:",e$message), type = "error")
NULL
})
if(!is.null(out))
{
if(is.element('population_name', names(out)))
out$population_name <- NULL
output$calcLD_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
options = list(
scroller = TRUE,
scrollY = "300px",
dom = 'lfrtBip',  # Place
buttons = c('copy', 'csv', 'excel')  # Add download buttons
)
)
})
}
else
{
showNotification("No LD were found.", type = "error")
output$calcLD_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_2')
shinyjs::hide("loading-spinner_2")
}
})
##### 3rd Run button click ##### find rsID
observeEvent(input$run_rsfindertab, {
chr <- as.numeric(trimws(input$chr_rsfindertab))
start_pos <- as.numeric(trimws(input$pos_1_rsfindertab))
end_pos <- as.numeric(trimws(input$pos_2_rsfindertab))
build <- as.numeric(trimws(input$build_rsfindertab))
# Validate inputs
if (is.null(chr) || is.null(start_pos) || is.null(end_pos) ||
is.na(chr) || is.na(start_pos) || is.na(end_pos) ||
chr=="" || start_pos == "" || end_pos =="") {
showNotification("Please provide valid input.", type = "error")
return()
}else{
shinyjs::disable('run_rsfindertab')
shinyjs::show("loading-spinner_rsfindertab")
out <- tryCatch({
SNPannotator::findRSID(chromosome = chr, start_position = start_pos,end_position = end_pos,build = build)
},
error = function(e)
{
showNotification(paste0("Error:",e$message), type = "error")
NULL
})
if(!is.null(out))
output$findrsidtab_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
options = list(
scroller = TRUE,
scrollY = "300px",
dom = 'lfrtBip',
buttons = c('copy', 'csv', 'excel'),
columnDefs = list(
list(className = 'dt-center', targets = "_all")
)
),
class = "compact cell-border stripe"
)
})
else
{
showNotification("No variants were found.", type = "error")
output$findrsidtab_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_rsfindertab')
shinyjs::hide("loading-spinner_rsfindertab")
}
})
##### 4th Run button click ##### find genpos
observeEvent(input$run_genposfindertab, {
rsid <- trimws(input$rsid_genposfindertab)
# Validate inputs
if (is.null(rsid) || is.na(rsid) || rsid=="" ) {
showNotification("Please provide valid input.", type = "error")
return()
}else{
shinyjs::disable('run_genposfindertab')
shinyjs::show("loading-spinner_genposfindertab")
out <- tryCatch({
SNPannotator::findGenomicPos(id = rsid)
},
error = function(e)
{
showNotification(paste0("Error:",e$message), type = "error")
NULL
})
if(!is.null(out))
output$genposfinder_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
options = list(
scroller = TRUE,
scrollY = "300px",
dom = 'lfrtBip',
buttons = c('copy', 'csv', 'excel'),
columnDefs = list(
list(className = 'dt-center', targets = "_all")
)
),
class = "compact cell-border stripe"
)
})
else
{
showNotification("No variants were found.", type = "error")
output$genposfinder_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_genposfindertab')
shinyjs::hide("loading-spinner_genposfindertab")
}
})
##### 5th Run button click ##### annotator
observeEvent(input$run_3, {
rsID <- input$variantID_3
build <- input$build_3
window <- input$window_3
r2 <- input$r2_3
db <- switch(input$population_3,
'eur'='1000GENOMES:phase_3:EUR',
'afr'='1000GENOMES:phase_3:AFR',
'amr'='1000GENOMES:phase_3:AMR',
'1000GENOMES:phase_3:ALL'
)
LDlist <- switch(input$LDlist_3,
'yes'= TRUE,
'no' = FALSE
)
# Validate inputs
if (is.null(rsID) | is.na(rsID) | rsID=='' | !startsWith(rsID,'rs')) {
showNotification("Please provide valid input.", type = "error")
return()
}else{
shinyjs::disable('run_3')
shinyjs::show("loading-spinner_3")
config.list=list()
config.list["rslist"] = rsID
config.list["build"] = build
config.list["db"] = db
config.list["window_size"] = window
config.list["r2"] = r2
config.list["LDlist"] = LDlist
config.list["nearestGene_type"] = "all"
out <- tryCatch({
SNPannotator::annotate_shiny(config.list)
},
error = function(e)
{
showNotification(paste0("Error:",e$message), type = "error")
NULL
})
if(!is.null(out))
output$annotator_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
escape = FALSE,
options = list(
deferRender = TRUE,
pageLength = 50,
lengthMenu = c(10, 50, 100, 500, 1000),
scroller = TRUE,
scrollY = "100%",
scrollX = "100%",
autoWidth = TRUE,
dom = 'lfrtBip',
buttons = c('copy', 'csv', 'excel'),
columnDefs = list(
list(className = 'dt-center', targets = "_all")
)
),
class = "compact cell-border stripe"
) %>%
formatStyle(
"Phenotype",
target = "cell",
fontSize = "12px",
whiteSpace = "nowrap",
overflow = "hidden",
textOverflow = "ellipsis",
maxWidth = "50px"
)
})
else
{
showNotification("No data were found.", type = "error")
output$annotator_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_3')
shinyjs::hide("loading-spinner_3")
}
})
}
# Run the App
shinyApp(ui, server)
a=read.table('clipboard')
a
a=read.table('clipboard',header=T)
library(data.table)
a
a$REF_RSID <- NULL
a$PVALUE = 1e-10
rrand(10)
rnorm(10,1e-10)
rnorm(10,mean = 1e-10)
a$PVALUE = rnorm(10,mean= 1e-10,sd=1e-5)
a$PVALUE = rnorm(10,mean= 1e-10,sd = 1e-4)
a$PVALUE = rnorm(19,mean= 1e-10,sd = 1e-4)
a
a$SE = rnorm(19,mean= 1e-10,sd = 1e-4)
a$BETA = rnorm(19,mean= 1e-10,sd = 1e-4)
a
a$MARKER <- NULL
a
fwrite(a,file='e:/haixia.txt',quote=FALSE,sep = '\t')
library(data.table)
a <- fread('E:\\MyProj\\eQTL\\gwas_catalog_v1.0.2-associations_e108_r2023-01-30.tsv')
names(a)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
setwd('e:/MyProj/GWAS/tst/snpannotator/out4/')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
SNPannotator::EnsemblReleases()
SNPannotator::EnsemblReleases(build = 37)
a <- readRDS('E:\\MyProj\\GWAS\\tst\\snpannotator\\depression38\\depression38.rds')
View(a)
a <- SNPannotator::EnsemblReleases(build = 37)
a
a$releases
a$releases[1]
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
sub("^[^0-9]*([0-9]+).*", "\\1", "string")
sub("^[^0-9]*([0-9]+).*", "\\1", "string243")
as.numeric(sub("^[^0-9]*([0-9]+).*", "\\1", "string"))
as.numeric(sub("^[^0-9]*([0-9]+).*", "\\1", "string243"))
as.numeric(sub("^[^0-9]*([0-9]+).*", "\\1", "string37"))
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
SNPannotator::EnsemblReleases()
SNPannotator::EnsemblReleases()
SNPannotator::EnsemblReleases()
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output.tbl
pwd
pwd()
getwd()
a <- readRDS('inst/extdata/cytoband_grch37.rda')
load('inst/extdata/cytoband_grch37.rda')
cytoband_grch37
load('inst/extdata/gene_names_grch37.rda')
gene_names_grch37
table(gene_names_grch37$chr )
saveRDS(gene_names_grch37,'inst/extdata/cytoband_grch37.rds',compress = 'xz')
saveRDS(gene_names_grch37,'inst/extdata/cytoband_grch37.rds',compress = 'bzip2')
saveRDS(gene_names_grch37,'inst/extdata/cytoband_grch37.rds')
saveRDS(gene_names_grch37,'inst/extdata/cytoband_grch37.rds',compress = 'xz',compression_level = 9)
R.version$version.string
Sys.Date()
Sys.time()
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
dt <- data.table(
ID = c("A", "B", "C"),
Value1 = c(10, 20, 30),
Value2 = c(40, 50, 60),
Value3 = c(70, 80, 90)
)
library(data.table)
dt <- data.table(
ID = c("A", "B", "C"),
Value1 = c(10, 20, 30),
Value2 = c(40, 50, 60),
Value3 = c(70, 80, 90)
)
dt
t(dt)
transpose(dt)
a <- transpose(dt)
names(a)
rownames(a)
a <- t(dt)
rownames(a)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
library(SNPannotator)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
