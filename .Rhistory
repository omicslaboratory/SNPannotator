width: 60px;
height: 60px;
animation: spin 1s linear infinite;
}
@keyframes spin {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}
.shiny-spinner-hidden {
display: none;
}
.vertical-line {
border-left: 1px solid #ccc;
height: 100%;
}
.center-output {
display: flex;
justify-content: center;
}
.row {
display: flex; /* Enable flexbox for the row */
align-items: stretch; /* Stretch columns to equal height */
}
.footer {
background-color: #222d32;
color: white;
text-align: center;
padding: 10px;
position: fixed;
bottom: 0;
width: 100%;
left: 0;
}
.sidebar-menu li a {
font-size: 16px;
font-family: Georgia, serif, Arial, Helvetica, Tahoma, sans-serif;
}
.sidebar-menu li a i {
margin-right: 10px;
}
.hline{
border-top: 1px solid darkblue; margin-bottom:15px;
}
.shiny-notification {
position: fixed;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
width: 300px; /* Adjust width as needed */
text-align: center;
}
"))
),
tabItems(
#### home Tab ####
tabItem(
tabName = "homeTab",
h2("SNPannotator"),
h3("Investigating the Functional Characteristics of Selected SNPs and Their Vicinity Genomic Region."),
tags$div(class = "hline"),
p("To investigate the functional characteristics of selected SNPs and their vicinity genomic region.
Linked SNPs in moderate to high linkage disequilibrium (e.g. r2>0.50) with the corresponding index SNPs will be
selected for further analysis."),
br(),
h4("Installation"),
p(HTML('The latest stable version is available from <a target="_blank"
href="https://CRAN.R-project.org/package=SNPannotator" rel="nofollow">CRAN</a> repository.')),
br(),
h4("License"),
p(HTML('
SNPannotator is licensed under the GNU General Public License,
version 3 <a href="https://www.gnu.org/licenses/gpl-3.0.html" target="_blank">(GPL-3.0)</a>.
')),
br(),
h4("Requirements"),
p(HTML('R 4 or higher'))
),
##### First Tab ####
tabItem(
tabName = "findLDTab",
h2("Find proxy variants"),
p("You can find variants that are in high LD with your input variant."),
tags$div(class = "hline"),
fluidRow(column(2,
fluidRow(column(12, textInput("variantID_1", label = tags$div(class = "label-on-top", "Variant ID:"), placeholder = 'rs697',width = "100%"))),
fluidRow(column(12, selectInput(
inputId = "build_1",
label = "Genomic build:",
choices = c("37" = "37",
"38" = "38"),
selected = "37"
))),
fluidRow(column(12, numericInput("window_1", "Window Size:", value = 500,min = 150,max=500,step = 50,width = "100%"))),
fluidRow(column(12, numericInput("r2_1", "R2:", value = 0.8,min = 0.1,max=1,step = 0.05,width = "100%"))),
fluidRow(column(12, selectInput(
inputId = "population_1",
label = "Select Population:",
choices = c("European" = "eur",
"African" = "afr",
"American" = "amr",
"All" = "all"
),
selected = "European"
))),
br(),
fluidRow(column(12, actionButton("run_1", "Run", class = "btn-primary",width = "40%")))),
column(1,div(id ="vl",class = "vertical-line")),
column(9,
DTOutput("findLD_output",width = "50%",fill = FALSE,height = "100%"),
div(
id = "loading-spinner_1",
class = "shiny-spinner-hidden",
tags$div(class = "shiny-spinner-container",
tags$div(class = "shiny-spinner"))
)
))),
#### Second Tab ####
tabItem(
tabName = "LDcalcTab",
h2("LD calculator"),
p("You can find the LD between two variants."),
tags$div(class = "hline"),
fluidRow(column(2,
fluidRow(column(12, textAreaInput(inputId = "variantIDs_2",placeholder = "rs697\nrs698",label =  "Enter items (one per line):",rows = 5, width = "100%"))),
fluidRow(column(12, selectInput(
inputId = "build_2",
label = "Genomic build:",
choices = c("37" = "37",
"38" = "38"),
selected = "37"
))),
fluidRow(column(12, selectInput(
inputId = "pairwise_2",
label = "Pairwise comparison:",
choices = c("No" = "no",
"Yes" = "yes"),
selected = "No"
))),
fluidRow(column(12, selectInput(
inputId = "population_2",
label = "Select Population:",
choices = c("European" = "eur",
"African" = "afr",
"American" = "amr",
"All" = "all"
),
selected = "European"
))),
br(),
fluidRow(column(12, actionButton("run_2", "Run", class = "btn-primary",width = "40%")))),
column(1,div(id ="vl",class = "vertical-line")),
column(9,
DTOutput("calcLD_output",width = "50%",fill = TRUE,height = "100%"),
div(
id = "loading-spinner_2",
class = "shiny-spinner-hidden",
tags$div(class = "shiny-spinner-container",
tags$div(class = "shiny-spinner"))
)))
),
##### Third Tab ####
tabItem(
tabName = "annotateTab",
h2("Annotate a genetic variant"),
p("You can annotate a variants using data from Ensembl."),
tags$div(class = "hline"),
fluidRow(column(2,
fluidRow(column(12, textInput("variantID_3", label = tags$div(class = "label-on-top", "Variant ID:"), placeholder = 'rs234',width = "100%"))),
fluidRow(column(12, selectInput(
inputId = "build_3",
label = "Genomic build:",
choices = c("37" = "grch37",
"38" = "grch38"),
selected = "grch37"
))),
fluidRow(column(12, numericInput("window_3", "Window Size:", value = 500,min = 150,max=500,step = 50,width = "100%"))),
fluidRow(column(12, numericInput("r2_3", "R2:", value = 0.8,min = 0.8,max=1,step = 0.05,width = "100%"))),
fluidRow(column(12, selectInput(
inputId = "population_3",
label = "Select Population:",
choices = c("European" = "eur",
"African" = "afr",
"American" = "amr",
"All" = "all"
),
selected = "European"
))),
fluidRow(column(12, selectInput(
inputId = "LDlist_3",
label = "Include proxy variants:",
choices = c("Yes" = "yes",
"No" = "no"
),
selected = "no"
))),
br(),
fluidRow(column(12, actionButton("run_3", "Run", class = "btn-primary",width = "40%")))),
column(1,div(id ="vl",class = "vertical-line")),
column(9,
DTOutput("annotator_output",width = "100%",fill = FALSE,height = "100%"),
div(
id = "loading-spinner_3",
class = "shiny-spinner-hidden",
tags$div(class = "shiny-spinner-container",
tags$div(class = "shiny-spinner"))
)
)))
),
tags$footer(
class = "footer",
HTML("Â© 2025 SNPannotator | All Rights Reserved | <a href='https://www.gnu.org/licenses/gpl-3.0.html' target='_blank'>GPL-3</a>")
)
)
)
#### Define Server  ####
server <- function(input, output, session) {
##### 1st Run button click #####
observeEvent(input$run_1, {
rsID <- input$variantID_1
build <- input$build_1
window <- input$window_1
r2 <- input$r2_1
db <- switch(input$population_1,
'eur'='1000GENOMES:phase_3:EUR',
'afr'='1000GENOMES:phase_3:AFR',
'amr'='1000GENOMES:phase_3:AMR',
'1000GENOMES:phase_3:ALL'
)
# Validate inputs
if (is.null(rsID) | is.na(rsID) | rsID=='' | !startsWith(rsID,'rs')) {
showNotification("Please provide valid input.", type = "error")
return()
}else{
shinyjs::disable('run_1')
shinyjs::show("loading-spinner_1")
out <- SNPannotator::findProxy(rslist = rsID,build = build,window_size = window,r2 = r2,db = db)
if(!is.null(out))
output$findLD_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
options = list(
scroller = TRUE,
scrollY = "300px",
dom = 'lfrtBip',
buttons = c('copy', 'csv', 'excel'),
columnDefs = list(
list(className = 'dt-center', targets = "_all")
)
),
class = "compact cell-border stripe"
)
})
else
{
showNotification("No Proxies were found.", type = "error")
output$findLD_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_1')
shinyjs::hide("loading-spinner_1")
}
})
##### 2nd Run button click #####
observeEvent(input$run_2, {
rsIDs <- strsplit(input$variantIDs_2, "\\n")[[1]]
build <- input$build_2
pairwise <- switch(input$pairwise_2,
'no'=FALSE,
'yes'=TRUE)
db <- switch(input$population_2,
'eur'='1000GENOMES:phase_3:EUR',
'afr'='1000GENOMES:phase_3:AFR',
'amr'='1000GENOMES:phase_3:AMR',
'1000GENOMES:phase_3:ALL')
# Validate inputs
if (length(rsIDs) <2)
{
showNotification("Please provide at least two valid rsIDs.", type = "error")
return()
}else{
shinyjs::disable('run_2')
shinyjs::show("loading-spinner_2")
out <- SNPannotator::pairwiseLD(rsList = rsIDs,build = build, db = db,pairwise = pairwise)
if(!is.null(out))
{
if(is.element('population_name', names(out)))
out$population_name <- NULL
output$calcLD_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
options = list(
scroller = TRUE,
scrollY = "300px",
dom = 'lfrtBip',  # Place
buttons = c('copy', 'csv', 'excel')  # Add download buttons
)
)
})
}
else
{
showNotification("No LD were found.", type = "error")
output$calcLD_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_2')
shinyjs::hide("loading-spinner_2")
}
})
##### 3rd Run button click #####
observeEvent(input$run_3, {
rsID <- input$variantID_3
build <- input$build_3
window <- input$window_3
r2 <- input$r2_3
db <- switch(input$population_3,
'eur'='1000GENOMES:phase_3:EUR',
'afr'='1000GENOMES:phase_3:AFR',
'amr'='1000GENOMES:phase_3:AMR',
'1000GENOMES:phase_3:ALL'
)
LDlist <- switch(input$LDlist_3,
'yes'= TRUE,
'no' = FALSE
)
# Validate inputs
if (is.null(rsID) | is.na(rsID) | rsID=='' | !startsWith(rsID,'rs')) {
showNotification("Please provide valid input.", type = "error")
return()
}else{
shinyjs::disable('run_3')
shinyjs::show("loading-spinner_3")
config.list=list()
config.list["rslist"] = rsID
config.list["build"] = build
config.list["db"] = db
config.list["window_size"] = window
config.list["r2"] = r2
config.list["LDlist"] = LDlist
config.list["nearestGene_type"] = "all"
out <- SNPannotator::annotate_shiny(config.list)
if(!is.null(out))
output$annotator_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
escape = FALSE,
options = list(
deferRender = TRUE,
pageLength = 50,
lengthMenu = c(10, 50, 100, 500, 1000),
scroller = TRUE,
scrollY = "100%",
scrollX = "100%",
autoWidth = TRUE,
dom = 'lfrtBip',
buttons = c('copy', 'csv', 'excel'),
columnDefs = list(
list(className = 'dt-center', targets = "_all")
)
),
class = "compact cell-border stripe"
) %>%
formatStyle(
"Phenotype",
target = "cell",
fontSize = "12px",
whiteSpace = "nowrap",
overflow = "hidden",
textOverflow = "ellipsis",
maxWidth = "50px"
)
})
else
{
showNotification("No data were found.", type = "error")
output$annotator_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_3')
shinyjs::hide("loading-spinner_3")
}
})
}
# Run the App
shinyApp(ui, server)
devtools::document()
annotate('e:/snpannotator/config.ini')
annotate('e:/snpannotator/config.ini')
annotate('e:/snpannotator/config.ini')
annotate('e:/snpannotator/config.ini')
annotate('e:/snpannotator/config.ini')
View(data)
geneList
annotate('e:/snpannotator/config.ini')
length(geneList)
paste(geneList,collapse = "%0d")
query
query
View(r)
content(r)
annotate('e:/snpannotator/config.ini')
annotate('e:/snpannotator/config.ini')
annotate('e:/snpannotator/config.ini')
annotate('e:/snpannotator/config.ini')
annotate('e:/snpannotator/config.ini')
annotate('e:/snpannotator/config.ini')
a <- readRDS('E:\\snpannotator\\output\\113.rds')
View(a)
View(a)
devtools::document()
run_annotation('e:/snpannotator/config.ini')
run_annotation('e:/snpannotator/config.ini')
getwd()
setwd('e:/snpannotator/output/1/')
demo_annotation()
getwd()
setwd('e:/snpannotator/output/1/')
demo_annotation()
getwd()
demo_annotation()
demo_annotation()
demo_annotation()
demo_annotation()
configFile
configurationFilePath
View(configs)
View(configs)
run_annotation('e:/snpannotator/config.ini')
View(configs)
demo_annotation()
configs$paths$output.tsv.file
setwd('e:/snpannotator/output/1/')
demo_annotation()
demo_annotation()
setwd('E:\\MyProj\\GWAS\\tst\\snpannotator\\out2')
devtools::document()
setwd("E:/MyProj/R_packages/GWASexplorer/R")
devtools::document()
setwd('E:\\MyProj\\GWAS\\tst\\snpannotator\\out2')
setwd('E:\\MyProj\\GWAS\\tst\\snpannotator\\out2')
SNPannotator::gene_enrichment('BTN1A1','BTN3A3')
SNPannotator::gene_enrichment(c('BTN1A1','BTN3A3'))
SNPannotator::gene_enrichment(c('BTN1A1','BTN3A3'))
SNPannotator::gene_enrichment(c('BTN1A1','BTN3A3'))
SNPannotator::gene_enrichment(c('BTN1A1','BTN3A3'))
SNPannotator::gene_enrichment(c('BTN1A1','BTN3A3'))
setwd("E:/MyProj/R_packages/GWASexplorer")
setwd('E:\\MyProj\\GWAS\\tst\\snpannotator\\out2')
SNPannotator::gene_enrichment(c('BTN1A1','BTN3A3'))
SNPannotator::gene_enrichment(c('BTN1A1','BTN3A3'))
gene_enrichment(c('BTN1A1','BTN3A3'))
gene_enrichment(c('BTN1A1','BTN3A3'))
gene_enrichment(c('BTN1A1','BTN3A3'))
gene_enrichment(c('BTN1A1','BTN3A3'))
.SNPannotator$verbose
.SNPannotator$verbose
.SNPannotator$verbose
gene_enrichment(c('BTN1A1','BTN3A3'))
gene_enrichment(c('BTN1A1','BTN3A3'))
gene_enrichment(c('BRCA2','BRCA1'))
gene_enrichment(c('BRCA2','BRCA1'))
gene_enrichment(c('BRCA2','BRCA1'))
geneList
server
enrich.report
description
string.report.list[['description']]
webLink
gene_enrichment(c('BRCA2','BRCA1'))
4 !== 'number'
4 == 'number'
type of 4 !== 'number'
typeof 4 !== 'number'
typeof 4
typeof(4)
typeof('d')
typeof(4)
typeof('4')
as.logical(TRUE)
as.logical('TRUE')
kl <- 3
as.name(kl)
as.character(as.name(kl))
deparse(kl)
deparse(substitute(kl))
devtools::document()
setwd('e:/MyProj/GWAS/tst/output/')
stringdb_annotation(c('BRCA1','BRCA2'),required_score = 700,limit = 5)
length(c('dsa','dsa'))
stringdb_annotation(c('BRCA1','BRCA2'),required_score = 700,limit = 5)
stringdb_annotation(c('BRCA1','BRCA2'),required_score = 700,limit = 5)
getwd()
setwd('e:/MyProj/GWAS/tst/output/')
stringdb_annotation('X',c('BRCA1','BRCA2','FAT'),required_score = 700,limit = 5)
getwd()
stringdb_annotation('X',c('BRCA1','BRCA2','FAT'),required_score = 700,limit = 5)
stringdb_annotation('sam1',c('BRCA1','BRCA2','FAT'),required_score = 700,limit = 20)
devtools::document()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::document()
library(SNPannotator)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
