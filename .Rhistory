h2("LD calculator"),
p("You can find the LD between two variants."),
tags$div(class = "hline"),
fluidRow(column(2,
fluidRow(column(12, textAreaInput(inputId = "variantIDs_2",placeholder = "rs697\nrs698",label =  "Enter items (one per line):",rows = 5, width = "100%"))),
fluidRow(column(12, selectInput(
inputId = "build_2",
label = "Genomic build:",
choices = c("37" = "37",
"38" = "38"),
selected = "37"
))),
fluidRow(column(12, selectInput(
inputId = "pairwise_2",
label = "Pairwise comparison:",
choices = c("No" = "no",
"Yes" = "yes"),
selected = "No"
))),
fluidRow(column(12, selectInput(
inputId = "population_2",
label = "Select Population:",
choices = c("European" = "eur",
"African" = "afr",
"American" = "amr",
"All" = "all"
),
selected = "European"
))),
br(),
fluidRow(column(12, actionButton("run_2", "Run", class = "btn-primary",width = "40%")))),
column(1,div(id ="vl",class = "vertical-line")),
column(9,
DTOutput("calcLD_output",width = "50%",fill = TRUE,height = "100%"),
div(
id = "loading-spinner_2",
class = "shiny-spinner-hidden",
tags$div(class = "shiny-spinner-container",
tags$div(class = "shiny-spinner"))
)))
),
#### Third Tab #### rsid finder
tabItem(
tabName = "rsidFinderTab",
h2("Find rsID"),
p("You can use this tab to find rsIDs in a genomic region."),
tags$div(class = "hline"),
fluidRow(column(2,
fluidRow(column(12, textInput(inputId = "chr_rsfindertab", label = tags$div(class = "label-on-top", "Chromosome:"), placeholder = '1',width = "100%"))),
fluidRow(column(12, textInput(inputId = "pos_1_rsfindertab", label = tags$div(class = "label-on-top", "Start position:"), placeholder = '1000',width = "100%"))),
fluidRow(column(12, textInput(inputId = "pos_2_rsfindertab", label = tags$div(class = "label-on-top", "End position:"), placeholder = '1001',width = "100%"))),
fluidRow(column(12, selectInput(
inputId = "build_rsfindertab",
label = "Genomic build:",
choices = c("37" = "37",
"38" = "38"),
selected = "37"
))),
br(),
fluidRow(column(12, actionButton("run_rsfindertab", "Run", class = "btn-primary",width = "40%")))),
column(1,div(id ="vl",class = "vertical-line")),
column(9,
DTOutput("findrsidtab_output",width = "50%",fill = TRUE,height = "100%"),
div(
id = "loading-spinner_rsfindertab",
class = "shiny-spinner-hidden",
tags$div(class = "shiny-spinner-container",
tags$div(class = "shiny-spinner"))
)))
),
#### Fourth Tab #### genpos finder
tabItem(
tabName = "genposFinderTab",
h2("Find genomic position"),
p("You can use this tab to find genomic position of a variant based on rsID."),
tags$div(class = "hline"),
fluidRow(column(2,
fluidRow(column(12, textInput("rsid_genposfindertab", label = tags$div(class = "label-on-top", "rsID:"), placeholder = 'rs245',width = "100%"))),
br(),
fluidRow(column(12, actionButton("run_genposfindertab", "Run", class = "btn-primary",width = "40%")))),
column(1,div(id ="vl",class = "vertical-line")),
column(9,
DTOutput("genposfinder_output",width = "50%",fill = TRUE,height = "100%"),
div(
id = "loading-spinner_genposfindertab",
class = "shiny-spinner-hidden",
tags$div(class = "shiny-spinner-container",
tags$div(class = "shiny-spinner"))
)))
),
##### Fifth Tab #### annotator
tabItem(
tabName = "annotateTab",
h2("Annotate a genetic variant"),
p("You can annotate a variants using data from Ensembl."),
tags$div(class = "hline"),
fluidRow(column(2,
fluidRow(column(12, textInput("variantID_3", label = tags$div(class = "label-on-top", "Variant ID:"), placeholder = 'rs234',width = "100%"))),
fluidRow(column(12, selectInput(
inputId = "build_3",
label = "Genomic build:",
choices = c("37" = "grch37",
"38" = "grch38"),
selected = "grch37"
))),
fluidRow(column(12, numericInput("window_3", "Window Size:", value = 500,min = 150,max=500,step = 50,width = "100%"))),
fluidRow(column(12, numericInput("r2_3", "R2:", value = 0.8,min = 0.8,max=1,step = 0.05,width = "100%"))),
fluidRow(column(12, selectInput(
inputId = "population_3",
label = "Select Population:",
choices = c("European" = "eur",
"African" = "afr",
"American" = "amr",
"All" = "all"
),
selected = "European"
))),
fluidRow(column(12, selectInput(
inputId = "LDlist_3",
label = "Include proxy variants:",
choices = c("Yes" = "yes",
"No" = "no"
),
selected = "no"
))),
br(),
fluidRow(column(12, actionButton("run_3", "Run", class = "btn-primary",width = "40%")))),
column(1,div(id ="vl",class = "vertical-line")),
column(9,
DTOutput("annotator_output",width = "100%",fill = FALSE,height = "100%"),
div(
id = "loading-spinner_3",
class = "shiny-spinner-hidden",
tags$div(class = "shiny-spinner-container",
tags$div(class = "shiny-spinner"))
)
)))
),
tags$footer(
class = "footer",
HTML("Â© 2025 SNPannotator | All Rights Reserved | <a href='https://www.gnu.org/licenses/gpl-3.0.html' target='_blank'>GPL-3</a>")
)
)
)
#### Define Server  ####
server <- function(input, output, session) {
##### 1st Run button click #####
observeEvent(input$run_1, {
rsID <- input$variantID_1
build <- input$build_1
window <- input$window_1
r2 <- input$r2_1
db <- switch(input$population_1,
'eur'='1000GENOMES:phase_3:EUR',
'afr'='1000GENOMES:phase_3:AFR',
'amr'='1000GENOMES:phase_3:AMR',
'1000GENOMES:phase_3:ALL'
)
# Validate inputs
if (is.null(rsID) | is.na(rsID) | rsID=='' | !startsWith(rsID,'rs')) {
showNotification("Please provide valid input.", type = "error")
return()
}else{
shinyjs::disable('run_1')
shinyjs::show("loading-spinner_1")
out <- tryCatch({
SNPannotator::findProxy(rslist = rsID,build = build,window_size = window,r2 = r2,db = db)
},
error = function(e)
{
showNotification(paste0("Error:",e$message), type = "error")
NULL
})
if(!is.null(out))
output$findLD_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
options = list(
scroller = TRUE,
scrollY = "300px",
dom = 'lfrtBip',
buttons = c('copy', 'csv', 'excel'),
columnDefs = list(
list(className = 'dt-center', targets = "_all")
)
),
class = "compact cell-border stripe"
)
})
else
{
showNotification("No Proxies were found.", type = "error")
output$findLD_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_1')
shinyjs::hide("loading-spinner_1")
}
})
##### 2nd Run button click #####
observeEvent(input$run_2, {
rsIDs <- strsplit(input$variantIDs_2, "\\n")[[1]]
build <- input$build_2
pairwise <- switch(input$pairwise_2,
'no'=FALSE,
'yes'=TRUE)
db <- switch(input$population_2,
'eur'='1000GENOMES:phase_3:EUR',
'afr'='1000GENOMES:phase_3:AFR',
'amr'='1000GENOMES:phase_3:AMR',
'1000GENOMES:phase_3:ALL')
# Validate inputs
if (length(rsIDs) <2)
{
showNotification("Please provide at least two valid rsIDs.", type = "error")
return()
}else{
shinyjs::disable('run_2')
shinyjs::show("loading-spinner_2")
out <- tryCatch({
SNPannotator::pairwiseLD(rsList = rsIDs,build = build, db = db,pairwise = pairwise)
},
error = function(e)
{
showNotification(paste0("Error:",e$message), type = "error")
NULL
})
if(!is.null(out))
{
if(is.element('population_name', names(out)))
out$population_name <- NULL
output$calcLD_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
options = list(
scroller = TRUE,
scrollY = "300px",
dom = 'lfrtBip',  # Place
buttons = c('copy', 'csv', 'excel')  # Add download buttons
)
)
})
}
else
{
showNotification("No LD were found.", type = "error")
output$calcLD_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_2')
shinyjs::hide("loading-spinner_2")
}
})
##### 3rd Run button click ##### find rsID
observeEvent(input$run_rsfindertab, {
chr <- as.numeric(trimws(input$chr_rsfindertab))
start_pos <- as.numeric(trimws(input$pos_1_rsfindertab))
end_pos <- as.numeric(trimws(input$pos_2_rsfindertab))
build <- as.numeric(trimws(input$build_rsfindertab))
# Validate inputs
if (is.null(chr) || is.null(start_pos) || is.null(end_pos) ||
is.na(chr) || is.na(start_pos) || is.na(end_pos) ||
chr=="" || start_pos == "" || end_pos =="") {
showNotification("Please provide valid input.", type = "error")
return()
}else{
shinyjs::disable('run_rsfindertab')
shinyjs::show("loading-spinner_rsfindertab")
out <- tryCatch({
SNPannotator::findRSID(chromosome = chr, start_position = start_pos,end_position = end_pos,build = build)
},
error = function(e)
{
showNotification(paste0("Error:",e$message), type = "error")
NULL
})
if(!is.null(out))
output$findrsidtab_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
options = list(
scroller = TRUE,
scrollY = "300px",
dom = 'lfrtBip',
buttons = c('copy', 'csv', 'excel'),
columnDefs = list(
list(className = 'dt-center', targets = "_all")
)
),
class = "compact cell-border stripe"
)
})
else
{
showNotification("No variants were found.", type = "error")
output$findrsidtab_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_rsfindertab')
shinyjs::hide("loading-spinner_rsfindertab")
}
})
##### 4th Run button click ##### find genpos
observeEvent(input$run_genposfindertab, {
rsid <- trimws(input$rsid_genposfindertab)
# Validate inputs
if (is.null(rsid) || is.na(rsid) || rsid=="" ) {
showNotification("Please provide valid input.", type = "error")
return()
}else{
shinyjs::disable('run_genposfindertab')
shinyjs::show("loading-spinner_genposfindertab")
out <- tryCatch({
SNPannotator::findGenomicPos(id = rsid)
},
error = function(e)
{
showNotification(paste0("Error:",e$message), type = "error")
NULL
})
if(!is.null(out))
output$genposfinder_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
options = list(
scroller = TRUE,
scrollY = "300px",
dom = 'lfrtBip',
buttons = c('copy', 'csv', 'excel'),
columnDefs = list(
list(className = 'dt-center', targets = "_all")
)
),
class = "compact cell-border stripe"
)
})
else
{
showNotification("No variants were found.", type = "error")
output$genposfinder_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_genposfindertab')
shinyjs::hide("loading-spinner_genposfindertab")
}
})
##### 5th Run button click ##### annotator
observeEvent(input$run_3, {
rsID <- input$variantID_3
build <- input$build_3
window <- input$window_3
r2 <- input$r2_3
db <- switch(input$population_3,
'eur'='1000GENOMES:phase_3:EUR',
'afr'='1000GENOMES:phase_3:AFR',
'amr'='1000GENOMES:phase_3:AMR',
'1000GENOMES:phase_3:ALL'
)
LDlist <- switch(input$LDlist_3,
'yes'= TRUE,
'no' = FALSE
)
# Validate inputs
if (is.null(rsID) | is.na(rsID) | rsID=='' | !startsWith(rsID,'rs')) {
showNotification("Please provide valid input.", type = "error")
return()
}else{
shinyjs::disable('run_3')
shinyjs::show("loading-spinner_3")
config.list=list()
config.list["rslist"] = rsID
config.list["build"] = build
config.list["db"] = db
config.list["window_size"] = window
config.list["r2"] = r2
config.list["LDlist"] = LDlist
config.list["nearestGene_type"] = "all"
out <- tryCatch({
SNPannotator::annotate_shiny(config.list)
},
error = function(e)
{
showNotification(paste0("Error:",e$message), type = "error")
NULL
})
if(!is.null(out))
output$annotator_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
escape = FALSE,
options = list(
deferRender = TRUE,
pageLength = 50,
lengthMenu = c(10, 50, 100, 500, 1000),
scroller = TRUE,
scrollY = "100%",
scrollX = "100%",
autoWidth = TRUE,
dom = 'lfrtBip',
buttons = c('copy', 'csv', 'excel'),
columnDefs = list(
list(className = 'dt-center', targets = "_all")
)
),
class = "compact cell-border stripe"
) %>%
formatStyle(
"Phenotype",
target = "cell",
fontSize = "12px",
whiteSpace = "nowrap",
overflow = "hidden",
textOverflow = "ellipsis",
maxWidth = "50px"
)
})
else
{
showNotification("No data were found.", type = "error")
output$annotator_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_3')
shinyjs::hide("loading-spinner_3")
}
})
}
# Run the App
shinyApp(ui, server)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
trans_consq_tbl
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
trans_consq_tbl
trans_consq_tbl
if('gene_symbol' %in% names(trans_consq_tbl))
trans_consq_tbl <- trans_consq_tbl[, gene_symbol := sapply(gene_symbol, function(x) {
if (length(x) == 0) "" else as.character(x)
})]
trans_consq_tbl
gene_symbol
if('gene_symbol' %in% names(trans_consq_tbl))
trans_consq_tbl <- trans_consq_tbl[, gene_symbol := sapply(gene_symbol, function(x) {
if (length(x) == 0) "" else as.character(x)
})]
trans_consq_tbl
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
trans_consq_tbl
name
View(varInfoList)
pos
View(varInfoList)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
trans_consq_tbl
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
devtools::document()
findProxy("rs234")
findProxy(rslist = 'rs234')
findProxy("rs234")
findProxy("rs234")
findProxy(c("rs234","rs678"))
findProxy("rs234")
pairwiseLD(c('rs234','rs10244533'))
findPairwiseLD(c('rs234','rs10244533'))
findPairwiseLD(c('rs234','rs10244533'),build = 37)
findPairwiseLD(c('rs234','rs10244533'),build = 37)
output_ld_tbl
output_ld_tbl
findPairwiseLD(c('rs234','rs10244533'),build = 37)
findPairwiseLD(c('rs234','rs10244533'),build = 37,file = 'e:/r.xlsx')
a <- findPairwiseLD(c('rs234','rs10244533'),build = 37,file = 'e:/r.xlsx')
findProxy('rs234',file = 'e:/r.xlsx')
dirname('e:/fsd/sdf.fsd')
dirname('sdf.fsd')
dir.exists('.')
getwd()
findRSID(15, 79845218)
findGenomicPos('rs121')
findGenomicPos('7_24898067_A_G', type = "varid", file_path  = "e:/output.xlsx")
findRSID(15, 79845218)
a <- findRSID(15, 79845218)
View(a)
findRSID(15, 79845218 , 79845238, file_path = "e:/output.xlsx")
findRSID(15, 79845218 , 79845238, file_path = "output.xlsx")
findRSID(15, 80137560 ,build= "37")
devtools::document()
devtools::build_vignettes()
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
View(varInfoList)
colocated_variants_table
same_allele
colocated_name
frq_tbl
View(frq_tbl)
avail_alleles
avail_frq
frq_vector
avail_frq
frq_vector
