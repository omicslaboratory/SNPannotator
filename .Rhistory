datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_2')
shinyjs::hide("loading-spinner_2")
}
})
##### 3rd Run button click ##### find rsID
observeEvent(input$run_rsfindertab, {
chr <- as.numeric(trimws(input$chr_rsfindertab))
start_pos <- as.numeric(trimws(input$pos_1_rsfindertab))
end_pos <- as.numeric(trimws(input$pos_2_rsfindertab))
build <- as.numeric(trimws(input$build_rsfindertab))
# Validate inputs
if (is.null(chr) || is.null(start_pos) || is.null(end_pos) ||
is.na(chr) || is.na(start_pos) || is.na(end_pos) ||
chr=="" || start_pos == "" || end_pos =="") {
showNotification("Please provide valid input.", type = "error")
return()
}else{
shinyjs::disable('run_rsfindertab')
shinyjs::show("loading-spinner_rsfindertab")
out <- tryCatch({
SNPannotator::findRSID(chromosome = chr, start_position = start_pos,end_position = end_pos,build = build)
},
error = function(e)
{
showNotification(paste0("Error:",e$message), type = "error")
NULL
})
if(!is.null(out))
output$findrsidtab_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
options = list(
scroller = TRUE,
scrollY = "300px",
dom = 'lfrtBip',
buttons = c('copy', 'csv', 'excel'),
columnDefs = list(
list(className = 'dt-center', targets = "_all")
)
),
class = "compact cell-border stripe"
)
})
else
{
showNotification("No variants were found.", type = "error")
output$findrsidtab_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_rsfindertab')
shinyjs::hide("loading-spinner_rsfindertab")
}
})
##### 4th Run button click ##### find genpos
observeEvent(input$run_genposfindertab, {
rsid <- trimws(input$rsid_genposfindertab)
# Validate inputs
if (is.null(rsid) || is.na(rsid) || rsid=="" ) {
showNotification("Please provide valid input.", type = "error")
return()
}else{
shinyjs::disable('run_genposfindertab')
shinyjs::show("loading-spinner_genposfindertab")
out <- tryCatch({
SNPannotator::findGenomicPos(id = rsid)
},
error = function(e)
{
showNotification(paste0("Error:",e$message), type = "error")
NULL
})
if(!is.null(out))
output$genposfinder_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
options = list(
scroller = TRUE,
scrollY = "300px",
dom = 'lfrtBip',
buttons = c('copy', 'csv', 'excel'),
columnDefs = list(
list(className = 'dt-center', targets = "_all")
)
),
class = "compact cell-border stripe"
)
})
else
{
showNotification("No variants were found.", type = "error")
output$genposfinder_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_genposfindertab')
shinyjs::hide("loading-spinner_genposfindertab")
}
})
##### 5th Run button click ##### annotator
observeEvent(input$run_3, {
rsID <- input$variantID_3
build <- input$build_3
window <- input$window_3
r2 <- input$r2_3
db <- switch(input$population_3,
'eur'='1000GENOMES:phase_3:EUR',
'afr'='1000GENOMES:phase_3:AFR',
'amr'='1000GENOMES:phase_3:AMR',
'1000GENOMES:phase_3:ALL'
)
LDlist <- switch(input$LDlist_3,
'yes'= TRUE,
'no' = FALSE
)
# Validate inputs
if (is.null(rsID) | is.na(rsID) | rsID=='' | !startsWith(rsID,'rs')) {
showNotification("Please provide valid input.", type = "error")
return()
}else{
shinyjs::disable('run_3')
shinyjs::show("loading-spinner_3")
config.list=list()
config.list["rslist"] = rsID
config.list["build"] = build
config.list["db"] = db
config.list["window_size"] = window
config.list["r2"] = r2
config.list["LDlist"] = LDlist
config.list["nearestGene_type"] = "all"
out <- tryCatch({
SNPannotator::annotate_shiny(config.list)
},
error = function(e)
{
showNotification(paste0("Error:",e$message), type = "error")
NULL
})
if(!is.null(out))
output$annotator_output <- renderDT({
datatable(out,
rownames = FALSE,
extensions = 'Buttons',
escape = FALSE,
options = list(
deferRender = TRUE,
pageLength = 50,
lengthMenu = c(10, 50, 100, 500, 1000),
scroller = TRUE,
scrollY = "100%",
scrollX = "100%",
autoWidth = TRUE,
dom = 'lfrtBip',
buttons = c('copy', 'csv', 'excel'),
columnDefs = list(
list(className = 'dt-center', targets = "_all")
)
),
class = "compact cell-border stripe"
) %>%
formatStyle(
"Phenotype",
target = "cell",
fontSize = "12px",
whiteSpace = "nowrap",
overflow = "hidden",
textOverflow = "ellipsis",
maxWidth = "50px"
)
})
else
{
showNotification("No data were found.", type = "error")
output$annotator_output <- renderDT({
datatable(data.frame(variant=0),  rownames = FALSE)
})
}
shinyjs::enable('run_3')
shinyjs::hide("loading-spinner_3")
}
})
}
# Run the App
shinyApp(ui, server)
a=read.table('clipboard')
a
a=read.table('clipboard',header=T)
library(data.table)
a
a$REF_RSID <- NULL
a$PVALUE = 1e-10
rrand(10)
rnorm(10,1e-10)
rnorm(10,mean = 1e-10)
a$PVALUE = rnorm(10,mean= 1e-10,sd=1e-5)
a$PVALUE = rnorm(10,mean= 1e-10,sd = 1e-4)
a$PVALUE = rnorm(19,mean= 1e-10,sd = 1e-4)
a
a$SE = rnorm(19,mean= 1e-10,sd = 1e-4)
a$BETA = rnorm(19,mean= 1e-10,sd = 1e-4)
a
a$MARKER <- NULL
a
fwrite(a,file='e:/haixia.txt',quote=FALSE,sep = '\t')
library(data.table)
a <- fread('E:\\MyProj\\eQTL\\gwas_catalog_v1.0.2-associations_e108_r2023-01-30.tsv')
names(a)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
setwd('e:/MyProj/GWAS/tst/snpannotator/out4/')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
SNPannotator::EnsemblReleases()
SNPannotator::EnsemblReleases(build = 37)
a <- readRDS('E:\\MyProj\\GWAS\\tst\\snpannotator\\depression38\\depression38.rds')
View(a)
a <- SNPannotator::EnsemblReleases(build = 37)
a
a$releases
a$releases[1]
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
sub("^[^0-9]*([0-9]+).*", "\\1", "string")
sub("^[^0-9]*([0-9]+).*", "\\1", "string243")
as.numeric(sub("^[^0-9]*([0-9]+).*", "\\1", "string"))
as.numeric(sub("^[^0-9]*([0-9]+).*", "\\1", "string243"))
as.numeric(sub("^[^0-9]*([0-9]+).*", "\\1", "string37"))
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
SNPannotator::EnsemblReleases()
SNPannotator::EnsemblReleases()
SNPannotator::EnsemblReleases()
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output.tbl
pwd
pwd()
getwd()
a <- readRDS('inst/extdata/cytoband_grch37.rda')
load('inst/extdata/cytoband_grch37.rda')
cytoband_grch37
load('inst/extdata/gene_names_grch37.rda')
gene_names_grch37
table(gene_names_grch37$chr )
saveRDS(gene_names_grch37,'inst/extdata/cytoband_grch37.rds',compress = 'xz')
saveRDS(gene_names_grch37,'inst/extdata/cytoband_grch37.rds',compress = 'bzip2')
saveRDS(gene_names_grch37,'inst/extdata/cytoband_grch37.rds')
saveRDS(gene_names_grch37,'inst/extdata/cytoband_grch37.rds',compress = 'xz',compression_level = 9)
R.version$version.string
Sys.Date()
Sys.time()
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
dt <- data.table(
ID = c("A", "B", "C"),
Value1 = c(10, 20, 30),
Value2 = c(40, 50, 60),
Value3 = c(70, 80, 90)
)
library(data.table)
dt <- data.table(
ID = c("A", "B", "C"),
Value1 = c(10, 20, 30),
Value2 = c(40, 50, 60),
Value3 = c(70, 80, 90)
)
dt
t(dt)
transpose(dt)
a <- transpose(dt)
names(a)
rownames(a)
a <- t(dt)
rownames(a)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
library(SNPannotator)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
devtools::document()
setwd('e:/MyProj/GWAS/tst/snpannotator/out4/')
demo_annotation()
library(SNPannotator)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
setwd('e:/MyProj/GWAS/tst/snpannotator/out4/')
demo_annotation()
demo_annotation()
demo_annotation()
demo_annotation()
demo_annotation()
demo_annotation()
demo_annotation()
demo_annotation()
pmin(10,32)
demo_annotation()
demo_annotation()
EnsemblDatabases()
EnsemblDatabases(build = 37)
EnsemblReleases()
EnsemblReleases(37)
findGenomicPos('rs111',file_path = 'f.xlsx')
findGenomicPos('7_24452905_T_C',type = 'varid',file_path = 'f.xlsx')
findGenomicPos('7_24452905_C_T',type = 'varid',file_path = 'f.xlsx')
findGenomicPos('7_24413286_T_C',type = 'varid',file_path = 'f.xlsx')
findPairwiseLD('rs111',file = 'c.xlsx')
findPairwiseLD(c('rs111','rs112'),file = 'c.xlsx')
output = findPairwiseLD(c('rs234', 'rs10244533'))
output
findProxy('rs111',file = 'r.xlsx')
findProxy(c('rs111','rs112'),file = 'r.xlsx')
findRSID(15, 79845218, 79845238, file_path = "output.xlsx")
getConfigFile()
getConfigFile('.')
stringdb_annotation('BC_project', c('BRCA1', 'BRCA2'), limit = 10)
stringdb_annotation('BC_project', c('BRCA1', 'BRCA2'), limit = 10)
run_stringdb_annotation('BC_project', c('BRCA1', 'BRCA2'), limit = 10)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
install_missing_packages <- function() {
pkgs <- c("data.table","httr","jsonlite","xml2","openxlsx","progress","ggplot2","kableExtra","methods","rmarkdown","ini","igraph","ggraph","futile.logger","png","readr")
# Identify missing packages
missing <- pkgs[!sapply(pkgs, requireNamespace, quietly = TRUE)]
if (length(missing) > 0) {
message("Installing missing packages: ", paste(missing, collapse = ", "))
install.packages(missing)
} else {
message("All required packages are already installed.")
}
}
install_missing_packages()
pkgs <- c("data.table","httr","jsonlite","xml2","openxlsx","progress",
"ggplot2","kableExtra","methods","rmarkdown","ini","igraph",
"ggraph","futile.logger","png","readr")
pkgs[!sapply(pkgs, requireNamespace, quietly = TRUE)]
pkgs <- c("data.table","httr","jsonlite","xml2","openxlsx","progress",
"ggplot2","kableExtra","methods","rmarkdown","ini","igraph",
"ggraph","futile.logger","png","readr","f")
pkgs[!sapply(pkgs, requireNamespace, quietly = TRUE)]
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
alleles_string
ref_all
colocated_variants_table
colocated_variants_table
frq_tbl
avail_frq
View(varInfoList)
varInfoList
varInfoList$variant_class
varInfoList$most_severe_consequence
varInfoList$seq_region_name
varInfoList$colocated_variants
varInfoList$assembly_name
varInfoList$transcript_consequence
varInfoList$allele_string
varInfoList$strand
trans_consq_tbl
trans_consq_tbl
trans_consq_tbl
paste(unique(trans_consq_tbl[variant_allele == minor_all,]$gene_symbol), collapse = ",")
trans_consq_tbl
geneNames
intergenic_consequences
varInfoList$intergenic_consequences
var_table
varInfoList$transcript_consequences
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
found
found[1]
found[1]['name']
found[1][['name']]
found[1]$name
class(found)
found[name=="",]
found[name=="",name := id]
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
View(varInfoList)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
View(varInfoList)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
View(varInfoList)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
View(varInfoList)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
View(varInfoList)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
View(varInfoList)
devtools::load_all(".")
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
View(varInfoList)
library(SNPannotator)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
View(varInfoList)
colocated_variants_table
trans_consq_tbl
trans_consq_tbl
trans_consq_tbl[, gene_symbol := sapply(gene_symbol, function(x) {
if (length(x) == 0) "" else as.character(x)
})]
trans_consq_tbl
trans_consq_tbl
trans_consq_tbl
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
trans_consq_tbl
minor_all
trans_consq_tbl[variant_allele == minor_all & distance  == "",]
trans_consq_tbl[distance  == "",]
trans_consq_tbl[variant_allele == minor_all & distance  == "",]
trans_consq_tbl
trans_consq_tbl[ distance  == "",]
trans_consq_tbl
View(trans_consq_tbl)
trans_consq_tbl[ is.null(distance),]
trans_consq_tbl[ distance == NULL,]
trans_consq_tbl[ distance == 'NULL',]
trans_consq_tbl[distance  == "", .N]
trans_consq_tbl <- trans_consq_tbl[variant_allele == minor_all,]
trans_consq_tbl
trans_consq_tbl[distance  == NULL, .N]
trans_consq_tbl[distance  == 'NULL', .N]
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
trans_consq_tbl
View(trans_consq_tbl)
trans_consq_tbl[, distance := sapply(distance, function(x) {
if (length(x) == 0 | x=='NULL') "" else as.character(x)
})]
trans_consq_tbl[, distance := sapply(distance, function(x) {
if (length(x) == 0 || x=='NULL') "" else as.character(x)
})]
View(trans_consq_tbl)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
View(varInfoList)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
colocated_variants_table
colocated_variants_table
avail_frq
trans_consq_tbl
trans_consq_tbl
trans_consq_tbl
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
trans_consq_tbl
unwanted_genes
trans_consq_tbl
trans_consq_tbl[!is.element(gene_id,unwanted_genes), ]
gene_id
unwanted_genes
trans_conq_tbl
trans_consq_tbl
trans_consq_tbl[variant_allele =='C',cadd_raw]
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
View(output)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
View(output)
View(output)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
trans_consq_tbl
trans_consq_tbl[gene_symbol=="",]
trans_consq_tbl[gene_symbol=="NULL",]
View(trans_consq_tbl)
View(varInfoList)
trans_consq_tbl[variant_allele == minor_all,]$gene_symbol
getString(trans_consq_tbl[variant_allele == minor_all,]$cadd_phred)
paste(unique(trans_consq_tbl[variant_allele == minor_all,]$biotype), collapse = ",")
paste(unique(trans_consq_tbl[variant_allele == minor_all,]$gene_id), collapse = ",")
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
View(output)
library(SNPannotator)
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
output <- run_annotation('E:\\MyProj\\GWAS\\tst\\snpannotator\\config.ini')
a=read.table('clipboard')
a
library(data.table)
setDT(a)
a[V1 ==V2,.N]
a[V1 !=V2,.N]
a
a=read.table('clipboard',header = T)
a
setDT(a)
a[gSNP ==  Linked_SNP,.N]
a[gSNP !=  Linked_SNP,.N]
a
